[{name:'User Manager',title:'User Manager',icon:38,prio:98,c:[{name:'Router',title:'Routers',type:'map',path:[ 100,3 ],autorefresh:1000,nameval:'Name',prefix:'router',refreshfilter:2,c:[{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Shared Secret',type:'secret',id:'s1'},{name:'Address',type:'addr',id:'m5',allow:'46/',width:100},{name:'CoA Port',type:'number',id:'u4',def:3799,max:65535,min:1,width:80},{name:'Access Requests',type:'number',id:'u67',ro:1,width:80},{name:'Access Failures',type:'number',id:'u68',ro:1,width:80},{type:'separator'},{name:'Broken Requests',type:'number',id:'u65',ro:1},{name:'Unknown Requests',type:'number',id:'u66',ro:1},{type:'separator'},{name:'Accounting Requests',type:'number',id:'u69',ro:1},{name:'Accounting Failures',type:'number',id:'u6a',ro:1},{type:'separator'},{name:'Disconnect Ack',type:'number',id:'u6b',ro:1},{name:'Disconnect Nak',type:'number',id:'u6c',ro:1},{type:'separator'},{name:'CoA Ack',type:'number',id:'u6d',ro:1},{name:'CoA Nak',type:'number',id:'u6e',ro:1},{type:'separator'},{name:'Sent From Cache',type:'number',id:'u6f',ro:1},{type:'enable'},{type:'comment'},{name:'Reset Counters',type:'doit',cmd:1,nonglobal:1}]},{title:'Settings',type:'item',path:[ 100,1 ],autorefresh:1000,refreshfilter:2,c:[{name:'Enabled',type:'bool',id:'b1'},{name:'Authentication Port',type:'number',id:'u2',max:65535,min:1},{name:'Accounting Port',type:'number',id:'u3',max:65535,min:1},{name:'Certificate',type:'enm',id:'u4',opt:1,values:{type:'dynamic',path:[ 19,1 ],pred:{type:'slot',pred:{type:'number',value:[ 1 ]},slot:'type'}}},{name:'Use Profiles',type:'bool',id:'b5'},{name:'Require Message Auth',type:'enm',id:'u6',values:{type:'static',map:[ '','no','yes access request' ]}},{type:'separator'},{name:'Active Sessions',type:'number',id:'u64',ro:1},{name:'Database',type:'contextmenu',autostart:1,link:[ ],open:'User Manager',tab:'Database'},{name:'Advanced',type:'contextmenu',autostart:1,link:[ ],open:'User Manager',tab:'Advanced'}]},{title:'Advanced',type:'item',path:[ 100,2 ],hide:1,c:[{name:'Web',type:'tab'},{name:'Private Username',type:'string',id:'s1'},{name:'Private Password',type:'secret',id:'s2'},{name:'Paypal',type:'tab'},{name:'Allow Paypal',type:'bool',id:'b64'},{name:'Use Sandbox',type:'bool',id:'b65'},{type:'separator'},{name:'User',type:'string',id:'s66'},{name:'Password',type:'secret',id:'s67'},{name:'Signature',type:'string',id:'s68'},{name:'Currency',type:'string',id:'s69'}]},{title:'Database',type:'item',path:[ 100,13 ],hide:1,c:[{name:'DB Path',type:'string',id:'s1'},{type:'separator'},{name:'Found Legacy DB Path',type:'string',id:'s4',opt:1,ro:1},{name:'DB Size',type:'bigbytes',id:'q2',ro:1},{name:'Free Disk Space',type:'bigbytes',id:'q3',ro:1},{name:'Load',title:'Load user-manager database backup',type:'doit',cmd:2,confirm:'Restore user-manager database?',errorprefix:'Failed to load user-manager database backup',global:1,ok:'Load',c:[{name:'Old Name',title:'Name',type:'string',id:'s7d1',on:'oldfileman',values:{type:'dynamic',path:[ 72 ],pred:{type:'slot',pred:{type:'number',value:[ 8 ]},slot:'type'}}},{name:'Name',type:'string',id:'s7d1',on:'newfileman',values:{type:'dynamic',path:[ 72,5 ],pred:{type:'slot',pred:{type:'number',value:[ 8 ]},slot:'type'}}},{name:'newfileman',type:'cond',hide:1,c:[{pred:{type:'supportmsgid'}}]},{name:'oldfileman',type:'cond',hide:1,c:[{pred:{type:'not',pred:{type:'supportmsgid'}}}]}]},{name:'Save',title:'Save user-manager database',type:'doit',cmd:1,errorprefix:'Failed to save user-manager database backup',global:1,ok:'Save',c:[{name:'Old Name',title:'Name',type:'string',id:'s7d1',on:'oldfileman',values:{type:'dynamic',path:[ 72 ],pred:{type:'slot',pred:{type:'number',value:[ 8 ]},slot:'type'}}},{name:'Name',type:'string',id:'s7d1',on:'newfileman',values:{type:'dynamic',path:[ 72,5 ],pred:{type:'slot',pred:{type:'number',value:[ 8 ]},slot:'type'}}},{name:'Overwrite',type:'bool',id:'b7d2'},{name:'newfileman',type:'cond',hide:1,c:[{pred:{type:'supportmsgid'}}]},{name:'oldfileman',type:'cond',hide:1,c:[{pred:{type:'not',pred:{type:'supportmsgid'}}}]}]},{name:'Optimize DB',type:'doit',cmd:4,confirm:'Optimize database?This can take a while depending on database size.',errorprefix:'Failed to optimize database',ok:'Optimize'},{type:'buttonsep'},{name:'Migrate Legacy Db',type:'doit',cmd:3,confirm:'Migrate from legacy database?',errorprefix:'Failed to migrate legacy data',global:1,ok:'Loading legacy data to new database',c:[{name:'Old Database Path',title:'Database Path',type:'string',id:'s7d1',on:'oldfileman',values:{type:'dynamic',path:[ 72 ],pred:{type:'slot',pred:{type:'number',value:[ 5 ]},slot:'type'}}},{name:'Database Path',type:'string',id:'s7d1',on:'newfileman',values:{type:'dynamic',path:[ 72,5 ],pred:{type:'slot',pred:{type:'number',value:[ 5 ]},slot:'type'}}},{name:'Overwrite',type:'bool',id:'b7d2'},{name:'newfileman',type:'cond',hide:1,c:[{pred:{type:'supportmsgid'}}]},{name:'oldfileman',type:'cond',hide:1,c:[{pred:{type:'not',pred:{type:'supportmsgid'}}}]}]}]},{title:'Generate Report',type:'doit',path:[ 100,15 ],cmd:1,c:[{name:'Columns',type:'set',id:'u7d1',values:{type:'static',map:['username','session start','session end','user ip','calling station id','uptime','download','upload','session id','nas ip','nas port type','nas port id','term. cause']}},{name:'Report Template',type:'string',id:'s7d3',strict:1,values:{type:'dynamic',path:[ 100,15 ],pred:{type:'slot',pred:{type:'number',value:[ 0 ]},slot:'tmplType'}}}]},{name:'User',title:'Users',type:'map',path:[ 100,4 ],autorefresh:1000,nameval:'Name',prefix:'user',refreshfilter:2,c:[{name:'General',type:'tab'},{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Password',type:'secret',id:'s1'},{name:'OTP Secret',type:'secret',id:'s8'},{name:'Group',type:'enm',id:'u5',values:{type:'dynamic',path:[ 100,5 ]},width:80},{type:'separator'},{name:'Caller ID',type:'string',id:'s3',values:{type:'static',map:[ 'bind' ]},width:60},{name:'Shared Users',type:'number',id:'u2',opt:1,width:55},{name:'Attributes',type:'multi',id:'M6',max:200,width:80,c:[{type:'tuple',sep:':',separate:1,c:[{type:'enm',id:'ufe0001',values:{type:'dynamic',path:[ 100,6 ]}},{type:'string',id:'s64'}]}]},{name:'Status',type:'tab'},{name:'Total Uptime',type:'interval',id:'u1f4',ro:1,width:80},{name:'Total Download',type:'bigbytes',id:'q1f5',ro:1,width:80},{name:'Total Upload',type:'bigbytes',id:'q1f6',ro:1,width:80},{name:'Active Sessions',type:'number',id:'u1f8',ro:1,width:55},{name:'Active Sub Sessions',type:'number',id:'u1fa',ro:1},{type:'separator'},{name:'Actual Profile',type:'enm',id:'u1f9',def:4294967295,opt:1,ro:1,values:{type:'dynamic',path:[ 100,7 ]}},{name:'Attributes Details',type:'multi',id:'M7',max:200,ro:1,c:[{type:'tuple',sep:':',c:[{type:'enm',id:'ufe0001',values:{type:'dynamic',path:[ 100,6 ]}},{type:'tuple',sep:':',c:[{type:'string',id:'s64'},{type:'tuple',sep:':0x',c:[{type:'enm',id:'u6',values:{type:'static',map:{1:'ip address',2:'string',3:'uint32',4:'hex',5:'ip6 prefix',100:'macro'}}},{type:'raw',id:'r65'}]}]}]}]},{name:'Generate Voucher',type:'contextmenu',link:[{dst:'User'}],open:'User Manager',tab:'Generate Voucher'},{type:'enable'},{type:'comment'}]},{title:'Generate Voucher',type:'doit',path:[ 100,15 ],cmd:2,hide:1,nonpublic:1,c:[{name:'User',type:'enm',id:'ufe0001',values:{type:'dynamic',path:[ 100,4 ]}},{name:'Voucher Template',type:'string',id:'s7d3',strict:1,values:{type:'dynamic',path:[ 100,15 ],pred:{type:'slot',pred:{type:'number',value:[ 1 ]},slot:'tmplType'}}}]},{title:'Add Batch Users',type:'doit',path:[ 100,4 ],cmd:1,c:[{name:'Number Of Users',type:'number',id:'u7d2',min:1},{name:'Username Length',type:'number',id:'u7d1',def:6,max:32,min:3},{name:'Username Prefix',type:'string',id:'s7d5'},{name:'Username Characters',type:'set',id:'u7d3',def:7,values:{type:'static',map:{0:'numbers',1:'uppercase',2:'lowercase'}}},{name:'Password Length',type:'enm',id:'u7d6',def:4294967295,values:{type:'static',map:{4294967294:'empty',4294967295:'same as username'}},c:[{type:'number'}]},{name:'Password Characters',type:'set',id:'u7d4',def:7,values:{type:'static',map:{0:'numbers',1:'uppercase',2:'lowercase'}}},{name:'Comment',type:'string',id:'sfe0009'},{name:'Profile',type:'enm',id:'u7d7',opt:1,values:{type:'dynamic',path:[ 100,7 ]}},{name:'Group',type:'enm',id:'u7d8',values:{type:'dynamic',path:[ 100,5 ]}},{name:'Caller ID',type:'string',id:'s3',values:{type:'static',map:[ 'bind' ]}},{name:'Shared Users',type:'number',id:'u2',def:1,opt:1},{name:'Disabled',type:'bool',id:'bfe000a'}]},{name:'User Group',title:'User Groups',type:'map',path:[ 100,5 ],nameval:'Name',prefix:'group',c:[{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Outer Auths',type:'set',id:'u2',values:{type:'static',map:['PAP','CHAP','MSCHAP1','MSCHAP2','EAP TLS','EAP TTLS','EAP PEAP','EAP MSCHAP2']},width:150},{type:'separator'},{name:'Inner Auths',type:'set',id:'u3',values:{type:'static',map:['TTLS PAP','TTLS CHAP','TTLS MSCHAP1','TTLS MSCHAP2','PEAP MSCHAP2']},width:150},{name:'Attributes',type:'multi',id:'M4',max:200,width:200,c:[{type:'tuple',sep:':',separate:1,c:[{type:'enm',id:'ufe0001',values:{type:'dynamic',path:[ 100,6 ]}},{type:'string',id:'s64'}]}]},{name:'default',type:'flag',id:'bfe000d',hint:'*'},{type:'comment'}]},{name:'Session',title:'Sessions',type:'map',path:[ 100,12 ],nameval:{type:'concat',first:'User',second:'Acct Session ID',sep:'/'},removable:1,ro:1,c:[{name:'User',type:'enm',id:'u1',values:{type:'dynamic',path:[ 100,4 ]},width:80},{name:'Acct Session ID',type:'string',id:'s8',opt:1,width:80},{name:'Acct Multi Session ID',type:'string',id:'s1c',opt:1},{name:'NAS Port Type',type:'enm',id:'u3',def:4294967295,opt:1,values:{type:'static',map:['async','sync','ISDN sync','ISDN sync V120','ISDN sync V110','virtual','piafs','HDLC','X25','X75','G3 Fax','SDSL','ADSL CAP','ADSL DMT','IDSL','ethernet','DSL','cable','wireless','wireless 802.11']}},{name:'NAS Port ID',type:'string',id:'s7',opt:1},{name:'NAS IP Address',type:'union',single:1,width:80,c:[{type:'ipaddr',id:'u6'},{type:'ip6addr',id:'a19'}]},{name:'Calling Station ID',type:'string',id:'s4',width:100},{name:'User Address',type:'ipaddr',id:'u5',opt:1,width:100},{type:'separator'},{name:'Started',type:'dateandtime',id:'uc',tz:1,width:100},{name:'Ended',type:'dateandtime',id:'ud',opt:1,tz:1,width:100},{name:'Terminate Cause',type:'enm',id:'ue',opt:1,values:{type:'static',map:{1:'User Request',2:'Lost Carrier',3:'Lost Service',4:'Idle Timeout',5:'Session Timeout',6:'Admin Reset',7:'Admin Reboot',8:'Port Error',9:'Nas Error',10:'Nas Request',11:'Nas Reboot',12:'Port Unneeded',13:'Port Preempted',14:'Port Suspended',15:'Service Unavailable',16:'Callback',17:'User Error',18:'Host Request',19:'Supplicant Restart',20:'Reauthentication Failure',21:'Port Reinitialized',22:'Port Administratively Disabled',16385:'Um User Deleted',16386:'Um User Disabled',16387:'Um Admin Request',16388:'Um Nas Rebooted',16389:'Um Simultaneous Sessions',16390:'Um Limits Reached',16391:'Um Limits Changed',16392:'Um Unknown'}},width:80},{type:'separator'},{name:'Uptime',type:'interval',id:'u15',opt:1,width:100},{name:'Download',type:'bigbytes',id:'q16',opt:1},{name:'Upload',type:'bigbytes',id:'q17',opt:1},{type:'separator'},{name:'Status',type:'set',id:'ub',values:{type:'static',map:['','Start','Stop','Interim','Close Acked','Expired']}},{name:'Last Accounting Packet',type:'dateandtime',id:'u11',tz:1},{name:'active',type:'flag',id:'bf',hint:'A'},{name:'Close Session',type:'doit',cmd:1}]},{name:'Profile',title:'Profiles',type:'map',path:[ 100,7 ],nameval:'Name',prefix:'prof',c:[{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Validity',type:'interval',id:'u1',values:{type:'static',map:[ 'unlimited' ]},width:80},{name:'Name For Users',type:'string',id:'s4',width:100},{name:'Starts When',type:'enm',id:'u2',values:{type:'static',map:[ 'first auth','assigned' ]},width:55},{name:'Price',type:'fixedpoint',id:'u3',low:0,scale:100,width:80},{name:'Override Shared Users',type:'enm',id:'u5',values:{type:'static',map:{0:'unlimited',4294967295:'off'}},width:80,c:[{type:'number'}]},{type:'comment'}]},{name:'User Profile',title:'User Profiles',type:'map',path:[ 100,8 ],nameval:'User',c:[{name:'User',type:'enm',id:'u1',values:{type:'dynamic',path:[ 100,4 ]},width:100},{name:'Profile',type:'enm',id:'u2',values:{type:'dynamic',path:[ 100,7 ]},width:100},{type:'separator'},{name:'State',type:'enm',id:'u3',ro:1,values:{type:'static',map:['waiting','running','running active','used']},width:100},{name:'End Time',type:'dateandtime',id:'u4',ro:1,tz:1,values:{type:'static',map:{4294967294:'not yet running',4294967295:'unlimited'}},width:100},{name:'Activate',type:'doit',cmd:1}]},{name:'Limitation',title:'Limitations',type:'map',path:[ 100,9 ],nameval:'Name',prefix:'lim',c:[{name:'Name',type:'string',id:'sfe0010',width:100},{name:'Download/Upload Limit',type:'tuple',separate:1,c:[{name:'Download Limit',type:'bigunit',id:'q1',width:80},{name:'Upload Limit',type:'bigunit',id:'q2',width:80}]},{name:'Transfer Limit',type:'bigunit',id:'q3',postfix:'B'},{name:'Session Limit',type:'interval',id:'u5',width:80},{type:'separator'},{name:'Rx/Tx Rate Limit',type:'tuple',separate:1,c:[{name:'Rx Rate Limit',type:'unit',id:'u50',width:80},{name:'Tx Rate Limit',type:'unit',id:'u51',width:80}]},{name:'Rx/Tx Min Rate Limit',type:'tuple',separate:1,c:[{name:'Rx Min Rate Limit',type:'unit',id:'u58'},{name:'Tx Min Rate Limit',type:'unit',id:'u59'}]},{name:'Rate Limit Priority',type:'number',id:'u5a'},{type:'separator'},{name:'Rx/Tx Rate Limit Burst',type:'tuple',separate:1,c:[{name:'Rx Rate Limit Burst',type:'unit',id:'u52',width:80},{name:'Tx Rate Limit Burst',type:'unit',id:'u53',width:80}]},{name:'Rx/Tx Rate Limit Burst Threshold',type:'tuple',separate:1,c:[{name:'Rx Rate Limit Burst Threshold',type:'unit',id:'u54'},{name:'Tx Rate Limit Burst Threshold',type:'unit',id:'u55'}]},{name:'Rx/Tx Rate Limit Burst Time',type:'tuple',separate:1,c:[{name:'Rx Rate Limit Burst Time',type:'interval',id:'u56'},{name:'Tx Rate Limit Burst Time',type:'interval',id:'u57'}]},{type:'separator'},{name:'Reset Counters Start Time',type:'dateandtime',id:'u13',opt:1},{name:'Reset Counters Interval',type:'interval',id:'u14',values:{type:'static',map:{0:'disabled',4294967292:'monthly',4294967293:'weekly',4294967294:'daily',4294967295:'hourly'}}},{type:'comment'}]},{name:'Profile Limitation',title:'Profile Limitations',type:'map',path:[ 100,10 ],nameval:'Profile',c:[{name:'Profile',type:'enm',id:'u1',values:{type:'dynamic',path:[ 100,7 ]},width:80},{name:'Limitation',type:'enm',id:'u2',values:{type:'dynamic',path:[ 100,9 ]},width:80},{name:'From Time',type:'interval',id:'u3',width:80},{name:'Till Time',type:'interval',id:'u4',width:80},{name:'Weekdays',type:'set',id:'u5',compact:1,values:{type:'static',map:['Sun','Mon','Tue','Wed','Thu','Fri','Sat']}},{type:'comment'}]},{name:'Attribute',title:'Attributes',type:'map',path:[ 100,6 ],nameval:'Name',prefix:'attr',c:[{name:'Name',type:'string',id:'sfe0010',width:60},{name:'Vendor ID',type:'number',id:'u1',values:{type:'static',map:{0:'standard',9:'Cisco',311:'Microsoft',14988:'Mikrotik'}},width:60},{name:'Type ID',type:'number',id:'u2',max:255,min:1,width:60},{name:'Value Type',type:'enm',id:'u6',values:{type:'static',map:{1:'ip address',2:'string',3:'uint32',4:'hex',5:'ip6 prefix',100:'macro'}},width:100},{name:'Packet Types',type:'set',id:'u3',values:{type:'static',map:[ 'access accept','access challenge' ]},width:80},{name:'Standard Name',type:'string',id:'s4',ro:1,width:80}]},{name:'Payment',title:'Payment',type:'map',path:[ 100,14 ],nameval:'User',removable:1,ro:1,c:[{name:'User',type:'enm',id:'uf',values:{type:'dynamic',path:[ 100,4 ]},width:80},{name:'Profile',type:'enm',id:'u10',values:{type:'dynamic',path:[ 100,7 ]},width:80},{name:'Price',type:'fixedpoint',id:'u3',scale:100,width:80},{name:'Currency',type:'string',id:'s4',width:45},{name:'Transaction Start',type:'dateandtime',id:'u1',tz:1,width:100},{name:'Transaction End',type:'dateandtime',id:'u2',opt:1,tz:1,width:100},{name:'Transaction Status',type:'enm',id:'u6',values:{type:'static',map:['started','pending','approved','declined','error','timeout','aborted','user approved']},width:80},{name:'Method',type:'enm',id:'u9',values:{type:'static',map:[ '','paypal','authorize net' ]}},{name:'User Message',type:'string',id:'s8'}]},{name:'',title:'Reports',type:'map',path:[ 100,15 ],hide:1,nameval:'Name',nonpublic:1,ro:1,c:[{name:'Name',type:'string',id:'sfe0010'},{name:'tmplType',type:'number',id:'u7d2',nonpublic:1}]}]}]